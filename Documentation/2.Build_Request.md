# Build A Request

RealHTTP offer a type-safe, perfectly Swift integrated way to build and configure a new http request.  

At the simplest you just need to provide a valid url both as `URL` or `String` (conversion happens automatically):

```swift
let todo = try await HTTPRequest("https://jsonplaceholder.typicode.com/todos/1")
                     .fetch(Todo.self)
```

The following code build a `GET` `HTTPRequest` and execute it into the `shared` `HTTPClient`Â instance.  
The result is therefore converted to `Codable` conform's `Todo` object.  
All asynchronously, all in a one line of code.

However not all requests are so simple; you may need to configure parameters, headers and the body, along with some other settings like timeout or retry/cache strategies.   
We'll look at this below.

## Initialize a Request

You have three different convenience ways to create a new request depending how many settings you would to change.

### Standard

You can use this method when your configuration is pretty simple, just the HTTP method and the absolute URL.  
This example create a post to add a new todo in [jsonplaceholder](https://jsonplaceholder.typicode.com) site using automatic json conversion *(you will learn more about body encoding below)*.

```swift
let req = try HTTPRequest(method: .post, "https://jsonplaceholder.typicode.com/posts",
                          body: try .json(["title": "foo", "body": "bar", "userId": 1]))
let _ = try await req.fetch()
```

### URI Template

RealHTTP also allows to create a request via URI Template as specified by [RFC6570](https://tools.ietf.org/html/rfc6570) using the [Kylef](https://github.com/kylef/URITemplate.swift) Swift implementation.  
A URI Template is a compact sequence of characters for describing a range of Uniform Resource Identifiers through variable expansion.  

```swift
let req = try HTTPRequest(URI: "https://jsonplaceholder.typicode.com/posts/{postId}", 
                          variables: ["postId": 1])
let _ = try await req.fetch()
```

### Builder Pattern

The most complete way to configure a request is by using the builder pattern initialization. It allows you to specify any property of the `HTTPRequest` inside a callback function which encapsulate and make clear the init process.

```swift
let req = HTTPRequest {
    $0.url = URL(string: "http://127.0.0.1:8081/login")!
    $0.method = .post
    $0.timeout = 15
    $0.redirectMode = redirect
}
let _ = try await req.fetch()
```